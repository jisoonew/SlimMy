<Window x:Class="SlimMy.View.ReportDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SlimMy.ViewModel"
        mc:Ignorable="d"
        Title="채팅방 신고"
        Width="640" Height="760"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#F7F7F9"
        d:DataContext="{d:DesignInstance Type=local:ReportDialogViewModel}">

    <Grid Margin="18">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Padding="16" CornerRadius="16" Background="White" BorderBrush="#E6E6EA" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel>
                    <TextBlock Text="채팅방 신고" FontSize="20" FontWeight="Bold" Foreground="#1E1E1E"/>
                    <TextBlock Margin="0,6,0,0"
                               Text="신고할 메시지를 선택하면 이 화면에서 미리보기로 확인할 수 있어요."
                               Foreground="#6B6B6B" TextWrapping="Wrap"/>
                </StackPanel>
            </Grid>
        </Border>

        <ScrollViewer Grid.Row="1" Margin="0,14,0,14" VerticalScrollBarVisibility="Auto">
            <StackPanel>

                <Border Padding="16" CornerRadius="16" Background="White" BorderBrush="#E6E6EA" BorderThickness="1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel>
                            <TextBlock Text="신고 대상" FontWeight="Bold" Foreground="#1E1E1E"/>
                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                <TextBlock Text="채팅방: " Foreground="#6B6B6B"/>
                                <TextBlock Text="{Binding ChatRoomTitle}" Foreground="#1E1E1E" FontWeight="SemiBold"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="방 ID: " Foreground="#6B6B6B"/>
                                <TextBlock Text="{Binding ChatRoomId}" Foreground="#1E1E1E"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="사용자(선택): " Foreground="#6B6B6B"/>
                                <TextBlock Text="{Binding TargetUserNickName}" Foreground="#1E1E1E"/>
                            </StackPanel>
                        </StackPanel>

                        <Border Grid.Column="1"
                                Background="#FFF1E8"
                                CornerRadius="999"
                                Padding="10,6"
                                VerticalAlignment="Top">
                            <TextBlock Text="{Binding TargetTypeLabel}" Foreground="#C14900" FontWeight="SemiBold"/>
                        </Border>
                    </Grid>
                </Border>

                <Border Margin="0,12,0,0" Padding="16" CornerRadius="16" Background="White" BorderBrush="#E6E6EA" BorderThickness="1">
                    <StackPanel>
                        <DockPanel>
                            <TextBlock Text="선택한 메시지 미리보기" FontWeight="Bold" Foreground="#1E1E1E" DockPanel.Dock="Left"/>
                            <TextBlock Text="{Binding SelectedCountText}" Foreground="#6B6B6B" DockPanel.Dock="Right"/>
                        </DockPanel>

                        <TextBlock Margin="0,6,0,10"
                                   Text="채팅 화면에서 체크한 메시지가 여기에 표시됩니다. (최대 선택 제한 권장)"
                                   Foreground="#6B6B6B" TextWrapping="Wrap"/>

                        <Border Background="#FAFAFC" BorderBrush="#E6E6EA" BorderThickness="1" CornerRadius="12" Padding="12"
                                Visibility="{Binding SelectedEmptyVisibility}">
                            <TextBlock Text="선택된 메시지가 없습니다. 채팅 화면에서 메시지를 선택해 주세요."
                                       Foreground="#A0A0A0" TextWrapping="Wrap"/>
                        </Border>

                        <!-- 메시지 미리보기 -->
                        <Border Background="#FAFAFC" BorderBrush="#E6E6EA" BorderThickness="1" CornerRadius="12" Padding="10"
                                Visibility="{Binding SelectedListVisibility}">
                            <ItemsControl ItemsSource="{Binding SelectedMessages}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="White" BorderBrush="#EDEDF2" BorderThickness="1" CornerRadius="12" Padding="12" Margin="0,6">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <StackPanel>
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding MessageContent}" FontWeight="SemiBold" Foreground="#1E1E1E"/>
                                                        <TextBlock Text=" · " Foreground="#A0A0A0"/>
                                                        <TextBlock Text="{Binding SentAtText}" Foreground="#6B6B6B"/>
                                                    </StackPanel>

                                                    <TextBlock Margin="0,8,0,0"
                                                               Text="{Binding MessageContent}"
                                                               Foreground="#1E1E1E"
                                                               TextWrapping="Wrap"/>
                                                </StackPanel>

                                                <Button Grid.Column="1"
                                                        Content="제외"
                                                        Padding="10,4"
                                                        Margin="10,0,0,0"
                                                        Background="#FFF0F0"
                                                        BorderBrush="#FFD2D2"
                                                        Foreground="#B00020"
                                                        Command="{Binding DataContext.RemoveSelectedMessageCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                        CommandParameter="{Binding}"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                    </StackPanel>
                </Border>

                <Border Margin="0,12,0,0" Padding="16" CornerRadius="16" Background="White" BorderBrush="#E6E6EA" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="신고 사유" FontWeight="Bold" Foreground="#1E1E1E"/>
                        <TextBlock Margin="0,6,0,10" Text="가장 가까운 사유를 선택해 주세요." Foreground="#6B6B6B"/>

                        <ComboBox Height="40"
          ItemsSource="{Binding ReasonOptions}"
          SelectedItem="{Binding SelectedReason}"
          DisplayMemberPath="Label"
          Background="#FAFAFC"
          BorderBrush="#E6E6EA"/>
                    </StackPanel>
                </Border>

                <Border Margin="0,12,0,0" Padding="16" CornerRadius="16" Background="White" BorderBrush="#E6E6EA" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="상세 내용" FontWeight="Bold" Foreground="#1E1E1E"/>
                        <TextBlock Margin="0,6,0,10"
                                   Text="무슨 일이 있었는지 간단히 적어주세요. (최소 20자 권장)"
                                   Foreground="#6B6B6B"/>

                        <TextBox Height="100"
                                 Text="{Binding DetailText, UpdateSourceTrigger=PropertyChanged}"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"
                                 Background="#FAFAFC"
                                 BorderBrush="#E6E6EA"
                                 Padding="12"/>

                        <DockPanel Margin="0,8,0,0">
                            <TextBlock DockPanel.Dock="Left"
                                       Text="{Binding DetailCountText}"
                                       Foreground="#6B6B6B"/>
                            <TextBlock DockPanel.Dock="Right"
                                       Text="최대 1000자"
                                       Foreground="#A0A0A0"/>
                        </DockPanel>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <Border Grid.Row="2" Padding="14" CornerRadius="16" Background="White" BorderBrush="#E6E6EA" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel>
                    <TextBlock Text="{Binding ValidationMessage}"
                               Foreground="#B00020"
                               Visibility="{Binding ValidationVisibility}"
                               Margin="0,0,0,6"/>
                    <TextBlock Text="허위 신고는 제재 대상이 될 수 있어요."
                               Foreground="#6B6B6B"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Height="42" MinWidth="140" Margin="10,0,0,0"
                            Background="#2563EB"
                            BorderBrush="#2563EB"
                            Foreground="White"
                            Command="{Binding SubmitCommand}"
                            IsEnabled="{Binding CanSubmit}"
                            Content="신고 제출"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
